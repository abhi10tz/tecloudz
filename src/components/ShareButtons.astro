---
// src/components/ShareButtons.astro
interface Props {
  title: string;
  description?: string;
}

const { title, description } = Astro.props;
const url = Astro.url;

// Encode for URL parameters
const shareUrl = encodeURIComponent(url.href);
const shareTitle = encodeURIComponent(title);
---

<div class="share-container">
  
  <div class="share-links">
    
    <a 
      href={`https://x.com/intent/tweet?text=${shareTitle}&url=${shareUrl}`} 
      target="_blank" 
      rel="noopener noreferrer" 
      aria-label="Share on X"
      class="share-btn"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
    </a>

    <a 
      href={`https://www.linkedin.com/sharing/share-offsite/?url=${shareUrl}`} 
      target="_blank" 
      rel="noopener noreferrer" 
      aria-label="Share on LinkedIn"
      class="share-btn"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"/></svg>
    </a>

    <a 
      href={`https://reddit.com/submit?url=${shareUrl}&title=${shareTitle}`} 
      target="_blank" 
      rel="noopener noreferrer" 
      aria-label="Share on Reddit"
      class="share-btn"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M22 12.068a2.534 2.534 0 0 0-1.77-2.428l.686-3.235 2.26.478a1.373 1.373 0 1 0 .348-1.583l-2.871-.607a1.036 1.036 0 0 0-1.228.784L18.66 8.78a9.423 9.423 0 0 0-6.652-2.71 9.426 9.426 0 0 0-6.66 2.71l-.764-3.26a1.036 1.036 0 0 0-1.226-.786l-2.873.607a1.372 1.372 0 1 0 .348 1.585l2.26-.48.688 3.236A2.534 2.534 0 0 0 2 12.068a2.52 2.52 0 0 0 1.639 2.378 13.905 13.905 0 0 0-.056 1.28c0 4.144 3.8 7.518 8.419 7.518s8.417-3.374 8.417-7.518a13.95 13.95 0 0 0-.058-1.28A2.522 2.522 0 0 0 22 12.068Zm-15.022 1.3a1.412 1.412 0 1 1 1.412-1.412 1.413 1.413 0 0 1-1.412 1.41Zm9.782 5.3a5.53 5.53 0 0 1-3.618 1.223 5.533 5.533 0 0 1-3.62-1.223.774.774 0 1 1 1.026-1.157 3.992 3.992 0 0 0 5.185 0 .774.774 0 1 1 1.027 1.157Zm.262-3.89a1.412 1.412 0 1 1 1.412-1.412 1.413 1.413 0 0 1-1.412 1.412Z"/></svg>
    </a>

    <button id="copy-btn" class="share-btn" aria-label="Copy Link">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
    </button>
  </div>
</div>

<script>
  // Simple script to copy URL to clipboard, compatible with View Transitions
  document.addEventListener('astro:page-load', () => {
    const copyBtn = document.getElementById('copy-btn');
    copyBtn?.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(window.location.href);
        alert('Link copied to clipboard!');
      } catch (err) {
        console.error('Failed to copy!', err);
      }
    });
  });
</script>

<style>
  .share-container {
    margin: 3rem 0;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .share-label {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-main);
  }

  .share-links {
    display: flex;
    gap: 0.8rem;
  }

  .share-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: var(--hover-bg); /* Subtle background */
    color: var(--text-muted);
    transition: all 0.2s ease;
    border: none;
    cursor: pointer;
  }

  .share-btn:hover {
    background-color: var(--text-main); /* Invert on hover */
    color: var(--bg-color);
    transform: translateY(-2px);
  }
</style>